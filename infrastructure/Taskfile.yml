# https://taskfile.dev

version: '3'

tasks:
  default:
    cmds:
      - terraform apply -auto-approve
      - terraform output -raw kubeconfig > ../kubeconfig
      - terraform output -raw talosconfig > ../talosconfig
      - helmfile init
      - helmfile apply
      - cilium status --wait
      - |
        flux bootstrap github \
          --context=admin@hoopa \
          --owner=navaneeth-dev \
          --repository=fluxcd-homelab \
          --branch=main \
          --personal \
          --path=k8s/clusters/sp
    silent: true
