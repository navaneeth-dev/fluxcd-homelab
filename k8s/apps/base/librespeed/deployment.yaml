apiVersion: apps/v1
kind: Deployment
metadata:
  name: &name librespeed
  namespace: homelab
spec:
  replicas: 1
  selector:
    matchLabels:
      app: *name
  template:
    metadata:
      labels:
        app: *name
    spec:
      containers:
        - name: *name
          image: ghcr.io/librespeed/speedtest:latest@sha256:7e43e57ee4c26645fc337b678db5f982f2b2cffe1116b807e7a16f7d8824635f
          ports:
            - containerPort: 80
          resources:
            limits:
              cpu: "100m"
              memory: "512Mi"
          volumeMounts:
            - name: librespeed-config
              mountPath: /config
      volumes:
        - name: librespeed-config
          nfs:
            server: 192.168.2.180
            path: "/srv/nfs4/config/librespeed"
